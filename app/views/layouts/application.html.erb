<!DOCTYPE html>
<html>
  <head>
    <title>Donutify</title>
    <%= csrf_meta_tags %>

    <%= stylesheet_link_tag    'application', media: 'all', 'data-turbolinks-track': 'reload' %>
    <%= javascript_include_tag 'application', 'data-turbolinks-track': 'reload' %>
    <script src="//maps.google.com/maps/api/js?key=<% ENV["google_api_key"] %>"></script>
    <script src="//cdn.rawgit.com/mahnunchik/markerclustererplus/master/dist/markerclusterer.min.js"></script>

  </head>

  <body>
    <%= yield %>


    <script type="text/javascript">
      var handler = Gmaps.build('Google');
      handler.buildMap({
          provider: {
            disableDefaultUI: true
            // pass in other Google Maps API options here
          },
          internal: {
            id: 'map'
          }
        },
        function(){
          markers = handler.addMarkers(
            <%=raw @hash.to_json %>
          );
          handler.bounds.extendWith(markers);
          handler.fitMapToBounds();
        }
      );
    </script>

  </body>
</html>
